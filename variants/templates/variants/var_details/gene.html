{% load dict %}
{% load humanize %}

<div class="card">
  <div class="card-header">
    <h4 class="card-title">Gene</h4>
  </div>
  <table class="card-body table table-striped table-sm">
    <tbody>
      <tr>
        <th>Entrez ID</th>
        <td>{{ gene.entrez_id }}</td>
      </tr>
      <tr>
        <th>ENSEMBL ID</th>
        <td>{{ gene.ensembl_gene_id }}</td>
      </tr>
      <tr>
        <th>Symbol</th>
        <td>{{ gene.symbol }}</td>
      </tr>
      <tr>
        <th>Alias Symbol</th>
        <td>{{ gene.alias_symbol|default:"<div class='text-muted text-center'><i>No alias symbol available.</i></div>" }}</td>
      </tr>
      <tr>
        <th>Name</th>
        <td>{{ gene.name }}</td>
      </tr>
      <tr>
        <th>Alias Names</th>
        <td>{{ gene.alias_name|default:"<div class='text-muted text-center'><i>No alias name available.</i></div>" }}</td>
      </tr>
      <tr>
        <th>Gene Family</th>
        <td>{{ gene.gene_family|default:"<div class='text-muted text-center'><i>No gene family information available.</i></div>" }}</td>
      </tr>
      <tr>
        <th>ClinVar</th>
        <td>
          {% if gene.clinvar_pathogenicity %}
            {% if gene.clinvar_pathogenicity.pathogenic_count %}
              <span class="badge-group">
                <span class="badge badge-light"># PATHOGENIC VARIANTS</span>
                <span class="badge badge-danger">{{ gene.clinvar_pathogenicity.pathogenic_count }}</span>
              </span>
            {% endif %}
            {% if gene.clinvar_pathogenicity.likely_pathogenic_count %}
              <span class="badge-group">
                <span class="badge badge-light"># LIKELY PATHOGENIC VARIANTS</span>
                <span class="badge badge-warning">{{ gene.clinvar_pathogenicity.likely_pathogenic_count }}</span>
              </span>
            {% endif %}
          {% else %}
            <div class="text-muted text-center"><i>No ClinVar information available.</i></div>
          {% endif %}
        </td>
      </tr>
      <tr>
        <th>NCBI Summary</th>
        <td>
          <div style="max-height: 150px; overflow-y: auto;">
            {{ ncbi_summary.summary|default:"<div class='text-muted text-center'><i>No NCBI information available.</i></div>" }}
          </div>
        </td>
      </tr>
      <tr>
        <th>Gene RIFs</th>
        <td>
          {% if ncbi_gene_rifs %}
            <ul class="pl-3" style="max-height: 150px; overflow-y: auto;">
              {% for gene_rif in ncbi_gene_rifs %}
                <li>{{ gene_rif.rif_text }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <div class="text-center text-muted">
              <i>No Reference-into-Function Information available.</i>
            </div>
          {% endif %}
        </td>
      </tr>
      <tr>
        <th>HPO Terms</th>
        <td>
          {% if not gene.hpo_terms and not gene.hpo_inheritance %}
            <div class="text-muted text-center"><i>No HPO information available.</i></div>
          {% else %}
            {% if gene.hpo_inheritance %}
              <div class="float-right">
              {% for hpo_id, mode in gene.hpo_inheritance %}
                <span class="badge badge-info" data-toggle="tooltip" title="{{ hpo_id }}">{{ mode }}</span>
              {% endfor %}
              </div>
            {% endif %}
            {% if gene.hpo_terms %}
              {% for hpo_id, hpo_name in gene.hpo_terms %}
                <a href="https://hpo.jax.org/app/browse/term/{{ hpo_id }}" target="_blank"><span class="badge-group">
                  <span class="badge badge-dark">{{ hpo_id }}</span><span class="badge badge-secondary">{{ hpo_name }}</span>
                </span></a>
              {% endfor %}
            {% endif %}
          {% endif %}
        </td>
      </tr>
      <tr>
        <th>OMIM</th>
        <td>
          {% if gene.omim %}
            {% for omim_id, omim_names in gene.omim.items %}
              <a href="#">
              <span class="badge-group omim-popover"
                    data-toggle="popover" title="{% if omim_names.1 %}<ul class='pl-3 pb-0 mb-0'><li>{{ omim_names.1|join:"</li><li>" }}</li></ul>{% else %}<em>No alternative description</em>{% endif %}" data-content="<a href='https://www.omim.org/entry/{{ omim_id }}' target='_blank' class='btn btn-secondary'><i class='fa fa-external-link'></i> View in OMIM</a>" data-html="true">
              <span class="badge badge-dark">{{ omim_id }}</span>
              <span class="badge badge-secondary">{{ omim_names.0 }}</span></span></a>
            {% endfor %}
          {% else %}
            <div class="text-muted text-center"><i>No OMIM information available.</i></div>
          {% endif %}
        </td>
      </tr>
    </tbody>
  </table>
</div>
